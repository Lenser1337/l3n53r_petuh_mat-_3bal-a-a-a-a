const Discord = require("discord.js");
const fs = require("fs");
const ms = require("ms");
var mongoose = require("mongoose");
mongoose.Promise = global.Promise;mongoose.connect(process.env.MONGO_URL);
var User = require('./../schemas/user_model.js');


function isNumeric(value) {
	return /^\d+$/.test(value);
}

function random(min, max) {
	var result = Math.floor(Math.random() * (max - min + 1)) + min;
	return (result);
}

module.exports.run = async (bot, message, args) => {

	var shop_channel = message.guild.channels.find(`name`, "üí∏–æ—Å–Ω–æ–≤–Ω–æ–µ_—ç–∫–æ–Ω–æ–º–∏–∫–∞");

	var retricIcon = bot.emojis.find("name", "retric");
	var simpleIcon = bot.emojis.find("name", "this_is_simple");

	var user_obj = User.findOne({
		userID: message.member.id
	}, function (err, foundObj) {
		if (err){
			console.log("Error on database findOne: " + err);
		}
		else {
			if (!foundObj)
				console.log("Something stange happend");
			else {
        //üïµ—Å–µ–∫—Ä–µ—Ç–Ω—ã–π_—á–∞—Ç / üç≤–∫–æ–º–Ω–∞—Ç–∞_–æ—Ç–¥—ã—Ö–∞
        if (message.channel.name != "üí∏–æ—Å–Ω–æ–≤–Ω–æ–µ_—ç–∫–æ–Ω–æ–º–∏–∫–∞" && message.channel.name != "üïµ—Å–µ–∫—Ä–µ—Ç–Ω—ã–π_—á–∞—Ç" && message.channel.name != "üç≤–∫–æ–º–Ω–∞—Ç–∞_–æ—Ç–¥—ã—Ö–∞" && message.channel.name != "üåégeneral_bots"){
          message.delete(5000);
          return message.reply(`—ç—Ç–æ–π –∫–æ–º–∞–Ω–¥–æ–π –º–æ–∂–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –≤ ${shop_channel}`).then(msg => msg.delete(10000));
        }

        if (typeof foundObj.gang === 'undefined' || foundObj.gang === null){
          message.delete(5000);
          return message.reply("—ç—Ç–æ–π –∫–æ–º–∞–Ω–¥–æ–π –º–æ–≥—É—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏!");
        }

				var dateTime = Date.now();
				var timestamp = Math.floor(dateTime/1000);
				var timestampLimit = Math.floor(foundObj.lastGangWork/1000) + 1800;

				if (timestampLimit > timestamp)
					return message.reply(`—Ç—ã —Å–ª–∏—à–∫–æ–º —É—Å—Ç–∞–ª... –û—Ç–¥–æ—Ö–Ω–∏ –µ—â–µ –Ω–µ–º–Ω–æ–≥–æ, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–∂–Ω–æ —Ä–∞–∑ –≤ 30 –º–∏–Ω—É—Ç ${simpleIcon}`);

				let toPay = random(750, 2000);
				let newCash = foundObj.retrocoinCash + toPay;
				foundObj.retrocoinCash = newCash;
				foundObj.retrocoinTotal = foundObj.retrocoinBank + newCash;
				foundObj.lastGangWork = dateTime;

				var answers = [];
				answers.push(`—Ç—ã —Ä–µ—à–∏–ª –ø–æ–¥—Ä–∞–±–æ—Ç–∞—Ç—å –≤ —Å—É—à–∏-–±–∞—Ä–µ,—Ç–µ–±—è —É–≤–æ–ª–∏–ª–∏ —É–∑–Ω–∞–≤ —á—Ç–æ —Ç—ã –∫—Ä–∞–¥—ë—à—å —Å—É—à–∏. –ù–æ —Ç—ã –ø–æ–ª—É—á–∏–ª –Ω–µ–º–Ω–æ–≥–æ –¥–µ–Ω–µ–≥ —Å –∏—Ö –ø—Ä–æ–¥–∞–∂–∏:${toPay} ${retricIcon}`);
				answers.push(`—Ç—ã —É—Å—Ç—Ä–æ–∏–ª—Å—è —Ä–∞–∑–Ω–æ—Å—á–∏–∫–æ–º –ø–∏—Ü—Ü—ã, –Ω–æ –Ω–µ —É—Å–ø–µ–ª —Ä–∞–∑–Ω–µ—Å—Ç–∏ –µ—ë –≤–æ–≤—Ä–µ–º—è, –∑–∞—Ç–æ —Ç—ã –ø–æ–º–æ–≥ –±–∞–±—É—à–∫–µ  –ø–µ—Ä–µ–π—Ç–∏ –¥–æ—Ä–æ–≥—É, –ø–æ–ª—É—á–∞–π${toPay} ${retricIcon}`);
				answers.push(`—Ç—ã —É—Å—Ç—Ä–æ–∏–ª—Å—è –ø—Ä–æ–≥—Ä–∞–º–∏—Ä–æ–≤–∞—Ç—å –Ω–æ –Ω–µ –∑–Ω–∞–ª –ü–∏—Ç–æ–Ω–∞! –¢—ã –£–í–û–õ–ï–ù! –Ω–æ —Ç–µ–±–µ –≤—ã–ø–ª–∞—Ç–∏—Ç–ª–∏ –ø—Ä–µ–¥–æ–ø–ª–∞—Ç—É —Ç–≤–æ–µ–≥–æ "—Ç—Ä—É–¥–∞",–ø–æ–ª—É—á–∞–π:${toPay} ${retricIcon}`);
				answers.push(`–ª—é–¥–∏ –≥–æ–≤–æ—Ä—è—Ç, —á—Ç–æ —Ä–∞–±–æ—Ç–∞—è —Ä—É–∫–∞–º–∏ –º–æ–∂–Ω–æ –º–Ω–æ–≥–æ–≥–æ –¥–æ—Å—Ç–∏—á—å. –†–∞–±–æ—Ç–∞—è –Ω–∞ —Å—Ç—Ä–æ–π–∫–µ, —Ç–µ–±–µ –≤—ã–ø–ª–∞—Ç–∏–ª–∏:${toPay} ${retricIcon}!`);
				answers.push(`—Ç—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–ª –ª–µ–∫–∞—Ä—Å—Ç–≤–æ –æ—Ç —Ä–∞–∫–∞, –≤–º–µ—Å—Ç–µ —Å –ø—Ä–µ–º–∏–µ–π —Ç—ã –ø–æ–ª—É—á–∏–ª:${toPay} ${retricIcon}!`);
				answers.push(`—Ç—ã –ø–æ—Ä–∞–±–æ—Ç–∞–ª –Ω–∞ —Å–ª–∞–≤—É, –Ω–æ —Ç–≤–æ–π –±–æ—Å—Å –Ω–µ –≤ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–∏, —Ç—ã –æ—Å—Ç–∞–ª—Å—è –±–µ–∑ –∑–∞—Ä–ø–ª–∞—Ç—ã, –Ω–æ –ø–æ –¥–æ—Ä–æ–≥–µ –¥–æ–º–æ–π —Ç—ã –Ω–∞—à–µ–ª ${toPay} ${retricIcon}!`);
				answers.push(`—Ç—ã –Ω–∞–ø–∏—Å–∞–ª –º–∞—Ä–∏–æ –Ω–∞ C++, –ø–æ–ª—É—á–∏ —Å–≤–æ—é –≤—ã—Ä—É—á–∫—É ${toPay} ${retricIcon}!`);
				answers.push(`–∫–∞–∫ –Ω–∞—Å—á–µ—Ç –æ—á–µ—Ä–µ–¥–Ω–æ–π –∫—Ä—É–∂–∫–∏ –ø–∏–≤–∞? -–ö–æ–Ω–µ—á–Ω–æ! –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é —Ç—ã —Ä–∞–±–æ—Ç–∞–µ—à—å –±–∞—Ä–º–µ–Ω–æ–º... –ü–æ–ª—É—á–∏ —Å–≤–æ–∏ ${toPay} ${retricIcon}!`);
				answers.push(`—Ç—ã —É–±—Ä–∞–ª—Å—è –¥–æ–º–∞ —É –±–æ–≥–∞—á–∞ –∏ —Å–≤–∏—Å—Ç–Ω—É–ª —É –Ω–µ–≥–æ ${toPay} ${retricIcon}!`);
				answers.push(`–ø—Ä–∏–¥—è –Ω–∞ —Ä–∞–±–æ—Ç—É —Ç–µ–±—è –∑–∞—Å—Ç–∞–≤–∏–ª–∏ –º—ã—Ç—å –ø–æ–ª! –≠—Ç–æ –±—ã–ª–∏ —Å–∞–º—ã–µ —Ç—è–∂–µ–ª—ã–µ ${toPay} ${retricIcon} –≤ —Ç–≤–æ–µ–π –∂–∏–∑–Ω–∏...`);
				answers.push(`—Ç—ã –¥–æ—Å—Ç–∞–≤–∏–ª –ø–∏—Ü—Ü—É –≤ –ü–æ–ª–∏—Ü–µ–π—Å–∫–∏–π —É—á–∞—Å—Ç–æ–∫ Retro Valley! –¢—ã –ø–æ–ª—É—á–∏–ª —Ä–µ—Å–ø–µ–∫—Ç –∏ ${toPay} ${retricIcon}!`);
				answers.push(`–ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏–≤ Windows —É –±–∞–±—É—à–∫–∏ —Ç—ã –ø–æ–ª—É—á–∏–ª ${toPay} ${retricIcon}!`);
				answers.push(`—Ç—ã —Ü–µ–ª—ã–π –¥–µ–Ω—å —Ä–µ–∫–ª–∞–º–∏—Ä–æ–≤–∞–ª –∫–∞–Ω–∞–ª Sallywan-a –∏ –ø–æ–ª—É—á–∏–ª ${toPay} ${retricIcon}!`);
				answers.push(`—Ç–µ–±—è –ø—Ä–∏–Ω—è–ª–∏ –Ω–∞ —Å—Ç–∞–∂–∏—Ä–æ–≤–∫—É –≤ –±–∞—Ä –Ω–æ —Ç—ã –æ–±–ª–∞–∂–∞–ª—Å—è! –ü–æ–ª—É—á–∏ —Å–≤–æ–∏ ${toPay} ${retricIcon} –∑–∞ –¥–µ–Ω—å —Ä–∞–±–æ—Ç—ã...`);
				answers.push(`—Ç—ã —Ü–µ–ª—ã–π –¥–µ–Ω—å –Ω–æ—Å–∏–ª –≤–æ–¥—É –∫–æ–º–∞–Ω–¥–µ –ø–æ –±–∞—Å–∫–µ—Ç–±–æ–ª—É! –î–µ—Ä–∂–∏ —Å–≤–æ–∏ ${toPay} ${retricIcon}!`);
				answers.push(`–ø—Ä–æ–¥–∞–≤–∞—è –∞—Ä–±—É–∑—ã –∫ —Ç–µ–±–µ –ø—Ä–∏—à—ë–ª –±–æ–≥–∞—á –∏ —Å–∫—É–ø–∏–ª –≤—Å–µ –∞—Ä–±—É–∑—ã! –¢–≤–æ–π –±–æ—Å—Å —Å–µ–≥–æ–¥–Ω—è –¥–æ–±—Ä—ã–π –∏ –¥–∞–ª —Ç–µ–±–µ ${toPay} ${retricIcon}!`);
				answers.push(`—Ç—ã –∑–∞–ø–∏—Å–∞–ª—Å—è –Ω–∞ –±–æ–π –≤ –∑–∞–ª–µ –Ω–∞ –æ–∫—Ä–∞–∏–Ω–µ –≥–æ—Ä–æ–¥–∞! –ò –≤–æ—Ç –±–æ–π –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è! –ë–∞—Ü-–±–∞—Ü...–¢–µ–±—è –≤—ã—Ä—É–±–∏–ª–∏. –ü–æ–ª—É—á–∞–π —Å–≤–æ–∏ ${toPay} ${retricIcon}!`);
				answers.push(`—Ç—ã –ø–ª–∞–≤–∞–ª –≤ —Ä–µ–∫–µ –∏ –Ω–∞—à—ë–ª –Ω–æ–≤—ã–π iPhone XS. –ü—Ä–æ–¥–∞–≤ –µ–≥–æ —Ç—ã –ø–æ–ª—É—á–∏–ª ${toPay} ${retricIcon}!`);
				answers.push(`—Ç—ã —Ä–∞–∑–≤–µ—Å–∏–ª —Å–≤–æ—é –∞–Ω–∫–µ—Ç—É "–•–æ–∂—É –∑–∞ –≤–∞—Å –Ω–∞ —Å—Ç—Ä–µ–ª–∫–∏" –Ω–∞ –º–µ—Å—Ç–Ω—ã–π —Å–∞–π—Ç —Ä–∞–∑–æ–≤—ã—Ö —Ä–∞–±–æ—Ç. –¢–µ–±—è –ø–æ–∑–≤–∞–ª–∏ –Ω–∞ —Å—Ç—Ä–µ–ª–∫—É. –¢—ã –æ—Ç–≤–µ—Å–∏–ª –ª—é–ª–µ–π 5-–∫–ª–∞—Å—Å–Ω–∏–∫–∞–º –∏ –ø–æ–ª—É—á–∏–ª ${toPay} ${retricIcon}!`);
				answers.push(`–≤–µ—Å—å –¥–µ–Ω—å —Ç—ã –ø–æ–∑–∏—Ä–æ–≤–∞–ª –¥–ª—è –ø–µ—Ä–≤–æ–∫—É—Ä—Å–Ω–∏–∫–æ–≤ –•—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞ –∏ –ø–æ–ª—É—á–∏–ª –∑–∞ —ç—Ç–æ ${toPay} ${retricIcon}!`);
				answers.push(`—Ç—ã —Å–Ω—è–ª—Å—è –≤ –ø–æ—Ä–Ω–æ–≥—Ä–∞—Ñ–∏–∏ –∏ –ø–æ–ª—É—á–∏–ª ${toPay} ${retricIcon}!`);
				answers.push(`—Ç—ã –ø–æ–º–æ–≥ —á–µ–º–ø–∏–æ–Ω—É —Å—Ç—Ä–∞–Ω—ã –ø–æ –∫–∞—Ä–∞—Ç–µ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—Å—è –∫ —á–µ–º–ø–∏–æ–Ω–∞—Ç—É! –¢—ã —Å —Å–∏–Ω—è–∫–∞–º–∏ –Ω–æ –∑–∞—Ç–æ —É —Ç–µ–±—è ${toPay} ${retricIcon}!`);
				answers.push(`–ø—Ä–æ—Å—Ç–æ—è–≤ —Ü–µ–ª—ã–π –¥–µ–Ω—å –≤ –æ—á–µ—Ä–µ–¥–∏ –∑–∞ –Ω–æ–≤—ã–º iPhone —Ç—ã –ø—Ä–æ–¥–∞–ª —Å–≤–æ—ë –º–µ—Å—Ç–æ! –¢–µ–±–µ —Ö–æ—á–µ—Ç—Å—è –ø–ª–∞–∫–∞—Ç—å –∏ —É —Ç–µ–±—è –±–æ–ª—è—Ç –Ω–æ–≥–∏ –Ω–æ —Ç—ã –∑–∞—Ä–∞–±–æ—Ç–∞–ª ${toPay} ${retricIcon}!`);
				answers.push(`—Ç—ã —É—Å—Ç—Ä–æ–∏–ª—Å—è —Å—Ç–∞–∂—ë—Ä–æ–º –≤ Epic Games. –¢—ã —Å–ª–∏–ª –∏–Ω—Ñ—É –°–∞–ª–ª–∏–≤–∞–Ω—É –ø—Ä–æ –≥—Ä—è–¥—É—â–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è. –¢–µ–±—è —É–≤–æ–ª–∏–ª–∏ –Ω–æ —É —Ç–µ–±—è –µ—Å—Ç—å ${toPay} ${retricIcon} –∏ —Ä–µ—Å–ø–µ–∫—Ç –°–∞–ª–ª–∏!`);
				answers.push(`—Ç—ã –Ω–∞—Ä–∏—Å–æ–≤–∞–ª –ø–æ—Ä—Ç—Ä–µ—Ç –°–∞–ª–ª–∏–≤–∞–Ω–∞ –∏ –ø—Ä–æ–¥–∞–ª –µ–≥–æ –Ω–∞ –ê–≤–∏—Ç–æ, –ø–æ–ª—É—á–∏–≤ ${toPay} ${retricIcon}!`);
				answers.push(`–≥–æ–¥—ã —Ç–≤–æ–µ–≥–æ –æ–±—É—á–µ–Ω–∏—è 3D-–º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—é, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–∏–¥–µ–æ –Ω–µ –ø—Ä–æ—à–ª–∏ –∑—Ä—è. –¢—ã —Å–æ–∑–¥–∞–ª –Ω–æ–≤–æ–µ –∏–Ω—Ç—Ä–æ –¥–ª—è –∫–∞–Ω–∞–ª–∞ –°–∞–ª–ª–∏–≤–∞–Ω–∞ –∏ –∑–∞—Ä–∞–±–æ—Ç–∞–ª ${toPay} ${retricIcon}!`);
				let index = Math.floor((Math.random() * answers.length));
				let answer = answers[index];

				message.reply(answer);

				foundObj.save(function(err, updatedObj){
				if(err)
					console.log(err);
				});
			}
		}
	});
}

module.exports.help = {
	name: "gangwork"
}
